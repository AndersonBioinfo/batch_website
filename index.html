<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Batch Coverage Report Generator</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>ğŸ§¬ Batch Coverage Report Generator</h1>
    <p style="color: #666; margin-top: -10px;">Upload 100 Excel files and generate all reports at once</p>

    <div class="card">
      <label for="excelUpload">ğŸ“Š Upload Multiple Excel Files (.xlsx / .xls)</label><br />
      <input 
        type="file" 
        id="excelUpload" 
        accept=".xlsx,.xls" 
        multiple
        style="margin-top: 8px;"
      />
      <p style="font-size: 12px; color: #666; margin-top: 5px;">
        ğŸ’¡ Tip: Select all 100 files at once (Ctrl+A or Cmd+A)
      </p>
    </div>

    <div class="card">
      <div id="progress" style="display: none; padding: 10px; background: #f0f0f0; border-radius: 4px; margin-bottom: 10px;">
        Ready to process...
      </div>
      <button id="downloadAllHtml">â¬‡ï¸ Download All HTML Reports (as ZIP)</button>
    </div>

    <div class="info">
      <strong>ğŸ“Œ Requirements:</strong><br />
      â€¢ Each Excel file = 1 patient/sample<br />
      â€¢ File name will be used as patient name<br />
      â€¢ Excel columns: <b>Gene_Name</b> and <b>%_1x</b><br />
      â€¢ All reports will be downloaded as a single ZIP file<br />
      <br />
      <strong>ğŸ“ Example:</strong><br />
      â€¢ Upload: patient1.xlsx, patient2.xlsx, ..., patient100.xlsx<br />
      â€¢ Get: gene_coverage_reports.zip containing 100 HTML files
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
